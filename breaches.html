<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XposedOrNot: Data Breaches Repository</title>
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.21/css/jquery.dataTables.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/buttons/1.6.2/css/buttons.dataTables.min.css">
    <style>
        .btn-label {
            cursor: default;
            background-color: #f7f7f7;
            border: none;
            padding: 6px 12px;
            vertical-align: middle;
            margin-right: 4px;
        }

        .dt-buttons {
            float: right;
        }

        .header, .footer {
            background-color: #f7f7f7;
            padding: 10px;
            text-align: center;
        }

        .container {
            padding: 20px;
        }
    </style>
          <script>
         (function (h, o, t, j, a, r) {
         h.hj = h.hj || function () {
         (h.hj.q = h.hj.q || []).push(arguments)
         };
         h._hjSettings = {
         hjid: 1613245,
         hjsv: 6
         };
         a = o.getElementsByTagName('head')[0];
         r = o.createElement('script');
         r.async = 1;
         r.src = t + h._hjSettings.hjid + j + h._hjSettings.hjsv;
         a.appendChild(r);
         })(window, document, 'https://static.hotjar.com/c/hotjar-', '.js?sv=');
         (function () {
         var script = document.createElement("script");
         script.onload = () => {
         window.GrafanaFaroWebSdk.initializeFaro({
         url: 'https://faro-collector-prod-us-east-0.grafana.net/collect/bafccf6af158ab3e03d190abce675a94',
         app: {
          name: 'xonniepub',
          version: "1.0.0",
         },
         });
         };
         script.src =
         "https://unpkg.com/@grafana/faro-web-sdk@^1.0.0/dist/bundle/faro-web-sdk.iife.js";
         document.head.appendChild(script);
         })();
      </script>
</head>
<body>
<div class="header">
    <h1>XposedOrNot: Data Breaches</h1>    
</div>

<div class="container mt-5">
    <table id="example" class="display" style="width:100%">
        <thead>
            <tr>
                <th>Breach ID</th>
                <th>Breach Date</th>
                <th>Domain</th>
                <th>Exposed Data</th>
                <th>Exposed Records</th>
                <th>Description</th>
                <th>Industry</th>
                <th>Password Risk</th>
                <th>Searchable</th>
                <th>Sensitive</th>
                <th>Verified</th>
            </tr>
        </thead>
    </table>
</div>

<div class="footer">
    <p> XposesdOrNot.com</p>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="https://cdn.datatables.net/1.10.21/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/buttons/1.6.2/js/dataTables.buttons.min.js"></script>
<script src="https://cdn.datatables.net/buttons/1.6.2/js/buttons.flash.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script>
<script src="https://cdn.datatables.net/buttons/1.6.2/js/buttons.html5.min.js"></script>
<script src="https://cdn.datatables.net/buttons/1.6.2/js/buttons.print.min.js"></script>
<script src="https://cdn.datatables.net/buttons/1.6.2/js/buttons.colVis.min.js"></script>
<script>
    function formatYesNo(data, reverse=false) {
        if ((data === "Yes" && !reverse) || (data === "No" && reverse)) {
            return '<span style="background-color: #28a745; color: white; padding: 5px 10px; border-radius: 15px;">' + data + '</span>';
        } else {
            return '<span style="background-color: #dc3545; color: white; padding: 5px 10px; border-radius: 15px;">' + data + '</span>';
        }
    }

    function formatPasswordRisk(data) {
        if (data === "plaintext" || data === "easytocrack") {
            return '<span style="background-color: #dc3545; color: white; padding: 5px 10px; border-radius: 15px;">' + data + '</span>';
        } else {
            return '<span style="background-color: #28a745; color: white; padding: 5px 10px; border-radius: 15px;">' + data + '</span>';
        }
    }

    function formatDescription(data) {
        if (data.split(' ').length > 40) {
            return data.split(' ').slice(0, 40).join(' ') + '... <a href="#" class="readMore">Read more</a><span style="display: none;">' + data + '</span>';
        } else {
            return data;
        }
    }

    $(document).ready(function() {
        $('#example').DataTable({
            ajax: {
                url: 'https://api.xposedornot.com/v1/breaches',
                dataSrc: 'Exposed Breaches',
                error: function (xhr, error, thrown) {
                    console.error("Error occurred: ", xhr, error, thrown);
                }
            },
            columns: [
                { data: 'Breach ID' },
                {
                    data: 'Breached Date',
                    render: function(data) {
                        var date = new Date(data);
                        return date.toLocaleString('default', { month: 'long', year: 'numeric' });
                    }
                },
                { data: 'Domain' },
                { 
                    data: 'Exposed Data',
                    render: function(data) {
                        return data.split(';').join(', ');
                    }
                },
                { 
                    data: 'Exposed Records',
                    render: $.fn.dataTable.render.number(',', '.')
                },
                {
                    data: 'Exposure Description',
                    render: function(data) {
                        return formatDescription(data);
                    }
                },
                { data: 'Industry' },
                {
                    data: 'Password Risk',
                    render: function(data) {
                        return formatPasswordRisk(data);
                    }
                },
                {
                    data: 'Searchable',
                    render: function(data) {
                        return formatYesNo(data);
                    }
                },
                {
                    data: 'Sensitive',
                    render: function(data) {
                        return formatYesNo(data, true);
                    }
                },
                {
                    data: 'Verified',
                    render: function(data) {
                        return formatYesNo(data);
                    }
                }
            ],
            order: [[1, 'desc']],
            dom: 'Blfrtip',
            buttons: [
                {
                    extend: 'colvis',
                    postfixButtons: ['colvisRestore'],
                    text: 'Select Columns',
                    className: 'pull-right'
                },
                'csvHtml5', 'excelHtml5', 
            ],
            initComplete: function() {
                $(".dt-buttons").prepend('<button class="btn btn-label">Export:</button> ');
            },
            language: {
                buttons: {
                    colvis: 'Select Columns'
                }
            }
        });

        $('#example').on('click', '.readMore', function(e) {
            e.preventDefault();
            $(this).parent().html($(this).next().text());
        });
    });
</script>
<script defer async src="https://www.googletagmanager.com/gtag/js?id=UA-108891851-1"></script>
<script src="static/scripts/common.js"></script>
</body>
</html>

